import{a as N}from"./axios-upsvKRUO.js";import{e as C,f as U,i as f,o as B,c as E,w as s,a,b as d,d as g,j as L,r as u,_ as R}from"./index-0a0EsJOX.js";const q=C({__name:"Form",setup($){const m=U(),b=(r,e,o)=>{if(e==="")o(new Error("请输入密码"));else{if(l.checkPass!==""){if(!m.value)return;m.value.validateField("checkPass")}o()}},V=(r,e,o)=>{e===""?o(new Error("请再次输入密码")):e!==l.pass?o(new Error("两次输入密码不一致!")):o()},l=f({name:"",email:"",pass:"",checkPass:"",realName:"",sex:"",fileList:[]}),_=f({pass:[{validator:b,trigger:"blur"}],checkPass:[{validator:V,trigger:"blur"}]}),c=async r=>{r&&r.validate(async e=>{if(e){console.log("Valid form data:",l);const o=new FormData;o.append("name",l.name),o.append("email",l.email),o.append("pass",l.pass),o.append("realName",l.realName),o.append("sex",l.sex),l.fileList.forEach(t=>{o.append("img",t)}),console.log("提交",o);try{const t=await N.post("/api/login/register",o,{headers:{"Content-Type":"multipart/form-data"}});console.log("Form submitted successfully:",t.data),t.data.code===1?L.push({path:"/assignments/submit",state:{data:t.data.data}}):console.error("后端返回错误:",t.data.msg)}catch(t){console.error("Error submitting form:",t)}}else console.log("error submit!")})},v=r=>{r&&r.resetFields()},y=r=>(console.log("文件准备上传：",r.name),!0),x=(r,e)=>ElMessageBox.confirm(`Cancel the transfer of ${r.name} ?`).then(()=>!0,()=>!1),F=async r=>{l.fileList.push(r.file),console.log(l.fileList[0])};return(r,e)=>{const o=u("el-input"),t=u("el-form-item"),i=u("el-option"),w=u("el-select"),p=u("el-button"),k=u("el-upload"),P=u("el-form");return B(),E(P,{ref_key:"FormRef",ref:m,style:{"max-width":"600px"},model:l,"status-icon":"",rules:_,"label-width":"auto",class:"Form"},{default:s(()=>[a(t,{label:"用户名"},{default:s(()=>[a(o,{modelValue:l.name,"onUpdate:modelValue":e[0]||(e[0]=n=>l.name=n)},null,8,["modelValue"])]),_:1}),a(t,{prop:"email",label:"邮箱地址",rules:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}]},{default:s(()=>[a(o,{modelValue:l.email,"onUpdate:modelValue":e[1]||(e[1]=n=>l.email=n)},null,8,["modelValue"])]),_:1}),a(t,{label:"设置密码",prop:"pass"},{default:s(()=>[a(o,{modelValue:l.pass,"onUpdate:modelValue":e[2]||(e[2]=n=>l.pass=n),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(t,{label:"确认密码",prop:"checkPass"},{default:s(()=>[a(o,{modelValue:l.checkPass,"onUpdate:modelValue":e[3]||(e[3]=n=>l.checkPass=n),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(t,{label:"真实姓名"},{default:s(()=>[a(o,{modelValue:l.realName,"onUpdate:modelValue":e[4]||(e[4]=n=>l.realName=n)},null,8,["modelValue"])]),_:1}),a(t,{label:"性别"},{default:s(()=>[a(w,{modelValue:l.sex,"onUpdate:modelValue":e[5]||(e[5]=n=>l.sex=n),placeholder:"请选择",size:"large",style:{width:"150px"}},{default:s(()=>[a(i,{label:"男",value:"male"}),a(i,{label:"女",value:"female"})]),_:1},8,["modelValue"])]),_:1}),a(t,null,{default:s(()=>[e[10]||(e[10]=d("        ")),a(k,{class:"upload-demo","http-request":F,"before-upload":y,"before-remove":x,limit:1},{tip:s(()=>e[9]||(e[9]=[g("div",{class:"el-upload__tip"},null,-1)])),default:s(()=>[a(p,{type:"primary"},{default:s(()=>e[8]||(e[8]=[d("上传头像")])),_:1})]),_:1})]),_:1}),a(t,null,{default:s(()=>[e[13]||(e[13]=g("br",null,null,-1)),e[14]||(e[14]=d("    ")),a(p,{type:"primary",onClick:e[6]||(e[6]=n=>c(m.value))},{default:s(()=>e[11]||(e[11]=[d(" 提交 ")])),_:1}),a(p,{onClick:e[7]||(e[7]=n=>v(m.value))},{default:s(()=>e[12]||(e[12]=[d("重置")])),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),j=R(q,[["__scopeId","data-v-66a79465"]]);export{j as default};
