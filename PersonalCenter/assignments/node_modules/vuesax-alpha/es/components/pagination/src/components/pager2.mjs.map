{"version":3,"file":"pager2.mjs","sources":["../../../../../../../packages/components/pagination/src/components/pager.vue"],"sourcesContent":["<template>\n  <div ref=\"pagerRef\" :class=\"nsPager.b()\">\n    <button\n      v-if=\"pageCount > 0\"\n      :class=\"[\n        nsPager.is('active', currentPage === 1),\n        nsPager.is('disabled', isPagerDisabled(1)),\n        nsPager.is('loading', isPagerLoading(1)),\n      ]\"\n      class=\"number\"\n      :aria-current=\"currentPage === 1\"\n      aria-label=\"1\"\n      :tabindex=\"tabindex(1)\"\n      @click=\"onPageClick(1)\"\n      @keyup.enter=\"onPageClick(1)\"\n    >\n      {{ buttonsDotted ? '' : 1 }}\n\n      <icon-loading v-if=\"isPagerLoading(1)\" :class=\"nsPager.e('loading')\" />\n    </button>\n    <button\n      v-if=\"showPrevMore && !buttonsDotted\"\n      :class=\"[\n        'more',\n        'btn-quickprev',\n        nsIcon.b(),\n        nsPager.is('disabled', disabled),\n      ]\"\n      :tabindex=\"tabindex()\"\n      @mouseenter=\"onMouseEnter(true)\"\n      @mouseleave=\"quickPrevHover = false\"\n      @focus=\"onFocus(true)\"\n      @blur=\"quickPrevFocus = false\"\n      @click=\"onMoreClick('prev')\"\n      @keyup.enter=\"onMoreClick('prev')\"\n    >\n      <chevron-left-double />\n      <span>...</span>\n    </button>\n    <button\n      v-for=\"pager in pagers\"\n      :key=\"pager\"\n      :class=\"[\n        nsPager.is('active', currentPage === pager),\n        nsPager.is('disabled', isPagerDisabled(pager)),\n        nsPager.is('loading', isPagerLoading(pager)),\n      ]\"\n      class=\"number\"\n      :aria-label=\"`${pager}`\"\n      :aria-current=\"currentPage === pager\"\n      :tabindex=\"tabindex(pager)\"\n      @click=\"onPageClick(pager)\"\n      @keyup.enter=\"onPageClick(pager)\"\n    >\n      {{ buttonsDotted ? '' : pager }}\n\n      <icon-loading\n        v-if=\"isPagerLoading(pager)\"\n        :class=\"nsPager.e('loading')\"\n      />\n    </button>\n    <button\n      v-if=\"showNextMore && !buttonsDotted\"\n      :class=\"[\n        'more',\n        'btn-quicknext',\n        nsIcon.b(),\n        nsPager.is('disabled', disabled),\n      ]\"\n      :tabindex=\"tabindex()\"\n      @mouseenter=\"onMouseEnter()\"\n      @mouseleave=\"quickNextHover = false\"\n      @focus=\"onFocus()\"\n      @blur=\"quickNextFocus = false\"\n      @click=\"onMoreClick('next')\"\n      @keyup.enter=\"onMoreClick('next')\"\n    >\n      <chevron-right-double />\n      <span>...</span>\n    </button>\n    <button\n      v-if=\"pageCount > 1\"\n      :class=\"[\n        nsPager.is('active', currentPage === pageCount),\n        nsPager.is('disabled', isPagerDisabled(pageCount)),\n        nsPager.is('loading', isPagerLoading(pageCount)),\n      ]\"\n      class=\"number\"\n      :aria-current=\"currentPage === pageCount\"\n      :aria-label=\"`${pageCount}`\"\n      :tabindex=\"tabindex(pageCount)\"\n      @click=\"onPageClick(pageCount)\"\n      @keyup.enter=\"onPageClick(pageCount)\"\n    >\n      {{ buttonsDotted ? '' : pageCount }}\n\n      <icon-loading\n        v-if=\"isPagerLoading(pageCount)\"\n        :class=\"nsPager.e('loading')\"\n      />\n    </button>\n\n    <div\n      :class=\"[nsPager.e('aria-active'), nsPager.is('change', isChange)]\"\n      :style=\"{ left: `${pageActive.left}px` }\"\n    >\n      {{ buttonsDotted ? '' : currentPage }}\n    </div>\n\n    <pagination-progress v-if=\"progress\" />\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, nextTick, reactive, ref, watch, watchEffect } from 'vue'\nimport { isNil } from 'lodash-unified'\nimport { useNamespace } from '@vuesax-alpha/hooks'\nimport { ChevronLeftDouble, ChevronRightDouble } from '@vuesax-alpha/icons-vue'\nimport { IconLoading } from '@vuesax-alpha/components/icon'\nimport { usePagination } from '../usePagination'\nimport { paginationPagerProps } from './pager'\nimport PaginationProgress from './progress.vue'\n\ndefineOptions({\n  name: 'VsPaginationPager',\n})\n\nconst props = defineProps(paginationPagerProps)\nconst emit = defineEmits(['change'])\nconst nsPager = useNamespace('pager')\nconst nsIcon = useNamespace('icon')\nconst {\n  currentPage,\n  disabled,\n  pageCount,\n  buttonsDotted,\n  isPagerDisabled,\n  isPagerLoading,\n} = usePagination()\n\nconst pagerRef = ref<HTMLElement>()\nconst showPrevMore = ref(false)\nconst showNextMore = ref(false)\nconst quickPrevHover = ref(false)\nconst quickNextHover = ref(false)\nconst quickPrevFocus = ref(false)\nconst quickNextFocus = ref(false)\nconst isChange = ref(false)\nconst pageActive = reactive({\n  left: 0,\n})\nconst pagers = computed(() => {\n  const pagerCount = props.pagerCount\n  const halfPagerCount = (pagerCount - 1) / 2\n\n  let showPrevMore = false\n  let showNextMore = false\n  if (pageCount.value > pagerCount) {\n    if (currentPage.value > pagerCount - halfPagerCount) {\n      showPrevMore = true\n    }\n    if (currentPage.value < pageCount.value - halfPagerCount) {\n      showNextMore = true\n    }\n  }\n  const array: number[] = []\n  if (showPrevMore && !showNextMore) {\n    const startPage = pageCount.value - (pagerCount - 2)\n    for (let i = startPage; i < pageCount.value; i++) {\n      array.push(i)\n    }\n  } else if (!showPrevMore && showNextMore) {\n    for (let i = 2; i < pagerCount; i++) {\n      array.push(i)\n    }\n  } else if (showPrevMore && showNextMore) {\n    const offset = Math.floor(pagerCount / 2) - 1\n    for (\n      let i = currentPage.value - offset;\n      i <= currentPage.value + offset;\n      i++\n    ) {\n      array.push(i)\n    }\n  } else {\n    for (let i = 2; i < pageCount.value; i++) {\n      array.push(i)\n    }\n  }\n  return array\n})\n\nconst tabindex = (index = Number.NaN) => (isPagerDisabled(index) ? -1 : 0)\n\nwatchEffect(() => {\n  const halfPagerCount = (props.pagerCount - 1) / 2\n  showPrevMore.value = false\n  showNextMore.value = false\n  if (pageCount.value! > props.pagerCount) {\n    if (currentPage.value > props.pagerCount - halfPagerCount) {\n      showPrevMore.value = true\n    }\n    if (currentPage.value < pageCount.value! - halfPagerCount) {\n      showNextMore.value = true\n    }\n  }\n})\n\nwatch([pagerRef, currentPage], () => {\n  nextTick(() => {\n    const pageActived: HTMLElement | null | undefined =\n      pagerRef.value?.querySelector(`[aria-label=\"${currentPage.value}\"]`)\n\n    // current page changed but dom not changing aria-label\n    // => pageActive null\n    // need to query after dom updated\n    if (isNil(pageActived) || isNil(pagerRef.value)) {\n      pageActive.left = 0\n      return\n    }\n    isChange.value = true\n\n    const offsetLeftButtonActive = pageActived.offsetLeft\n\n    pageActive.left = offsetLeftButtonActive\n\n    setTimeout(() => (isChange.value = false), 300)\n  })\n})\n\nfunction onMouseEnter(forward = false) {\n  if (disabled.value) return\n  if (forward) {\n    quickPrevHover.value = true\n  } else {\n    quickNextHover.value = true\n  }\n}\nfunction onFocus(forward = false) {\n  if (forward) {\n    quickPrevFocus.value = true\n  } else {\n    quickNextFocus.value = true\n  }\n}\n\nfunction onMoreClick(key: 'prev' | 'next') {\n  let newPage: number = currentPage.value\n  const pagerCountOffset = props.pagerCount - 2\n\n  if (key == 'prev') {\n    newPage = currentPage.value - pagerCountOffset\n  } else if (key == 'next') {\n    newPage = currentPage.value + pagerCountOffset\n  }\n  emitChange(newPage)\n}\n\nfunction onPageClick(page: number) {\n  if (!Number.isNaN(+page)) {\n    if (page < 1) page = 1\n    if (page > pageCount.value) page = pageCount.value\n  }\n  if (page != currentPage.value) emitChange(page)\n}\n\nfunction emitChange(page: number) {\n  if (disabled.value || Number.isNaN(+page)) return\n  emit('change', page)\n}\n</script>\n"],"names":["showPrevMore","showNextMore"],"mappings":"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"}